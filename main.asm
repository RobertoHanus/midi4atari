* -------------------------›* Symbols declaration›* -------------------------›* General use›COMTAB smb 'COMTAB'      ››* Console IO›PRINTF smb 'PRINTF'›GETS smb 'GETS'››* File operations›FOPEN smb 'FOPEN'›FCLOSE smb 'FCLOSE'›FGETS smb 'FGETS'›FILE_P smb 'FILE_P'›U_GETPAR smb 'U_GETPAR'›FILELENG smb 'FILELENG'››* -------------------------›* COMTABs used›* -------------------------›* COMFNAM buffer COMTAB+$21››* -------------------------›* SpartaDOS X regs›* -------------------------›* File operations›fmode equ $0778›fatr1 equ $0779›fhandle equ $0760›faux equ $0782››* -------------------------›* Declarations›* -------------------------›buffer_size equ 25››* -------------------------›* Main program›* -------------------------›      blk reloc main›      * Read cl parameter›      JSR U_GETPAR›      BNE openfile›      JSR PRINTF›      dta c'Must include a MIDI file parameter!'›      dta b($9B,$00)›      RTS››openfile JSR PRINTF›      * Prints file name on cli›      dta c'Opening file %s'›      dta b($9B,$00)›      dta v(COMTAB+$21)››      LDA filename_vector›      STA FILE_P›      LDA filename_vector+1›      STA FILE_P+1›      LDA #$04 File mode opening›      STA fmode›      LDA #$A0 Selected file attributes›      STA fatr1›      JSR FOPEN››* Get file length›      JSR FILELENG›* Print file length to console›      JSR PRINTF›      dta c'File length: %b'›      dta b($00)›      dta v(faux)››      LDA dta v(buffer)›      LDX dta v(buffer+1)›      LDY buffer_size›      JSR FGETS››      JSR PRINTF›      dta c'File content: %s'›      dta b($9B,$00)›      dta v(buffer)››      JSR FCLOSE›      RTS››* -------------------------›* Subroutines›* -------------------------›* Delay›* A = 1/60 seconds wait›* X = 1/60 * 256 seconds wait›* Y = 1/60 * 256 * 256 seconds wait›delay PHA›      LDA #0›      STA 18›      STA 19›      STA 20›      PLA›delay_y CPY 18›      BNE delay_y›delay_x  CPX 19›      BNE delay_x›delay_a CMP 20›      BNE delay_a›      RTS››* -------------------------›* Variables ›* (relocatable vectors)›* -------------------------›filename_vector dta v(COMTAB+$21)›buffer_vector dta v(buffer)››* -------------------------›* Variables ›* (actual data)›* -------------------------›value equ *›      dta b(25)››* -------------------------›* Buffers data space›* -------------------------›buffer equ *›      blk empty buffer_size main››      blk update addresses›      blk update symbols›      end›